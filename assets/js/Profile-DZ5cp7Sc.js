var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,t=(s,r,i)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[r]=i,l=(e,s)=>{for(var r in s||(s={}))a.call(s,r)&&t(e,r,s[r]);if(i)for(var r of i(s))n.call(s,r)&&t(e,r,s[r]);return e},c=(e,i)=>s(e,r(i)),d=(e,s)=>{var r={};for(var t in e)a.call(e,t)&&s.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&i)for(var t of i(e))s.indexOf(t)<0&&n.call(e,t)&&(r[t]=e[t]);return r},o=(e,s,r)=>t(e,"symbol"!=typeof s?s+"":s,r),m=(e,s,r)=>new Promise((i,a)=>{var n=e=>{try{l(r.next(e))}catch(s){a(s)}},t=e=>{try{l(r.throw(e))}catch(s){a(s)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,t);l((r=r.apply(e,s)).next())});import{j as x,_ as h,r as u,aa as f,a8 as p,ab as j,ac as g,F as v,ad as N,a1 as y,k as b,J as w,Y as C,ae as P,af as _,ag as k,ah as V,ai as S,aj as O,o as R,ak as T,z as q,al as I}from"./react-vendor-CnY34O61.js";import{A as F,a as M,b as z,c as U,d as A,L}from"./Layout-BPnBhQSp.js";import{g as D,d as E,t as $,u as B,B as G,C as Y,a as W,b as H,f as J,c as Q,s as K}from"./index-BBu7AVS9.js";import{L as X}from"./label-PSg-V1BV.js";import{D as Z,a as ee,b as se,c as re,d as ie,e as ae,T as ne}from"./textarea-Db-_GloC.js";import{aq as te,ar as le,as as ce,at as de}from"./vendor-CwuJVHC1.js";import{P as oe}from"./progress-DpWD15xE.js";import{f as me}from"./utils-vendor-BkyaMd0J.js";import{I as xe}from"./input-DGNBd0ih.js";import"./backend-vendor-CggdsxVJ.js";import"./ui-vendor-CttiZxwU.js";import"./query-vendor-DEKS82BJ.js";const he=({score:e})=>{const s=Math.round(e/100*5);return x.jsx("div",{className:"flex items-center gap-1 text-accent",children:Array.from({length:5}).map((e,r)=>x.jsx(h,{className:"h-4 w-4 "+(r<s?"fill-current":"")},r))})};const ue=new class{constructor(){o(this,"apiBaseUrl"),o(this,"environment"),this.apiBaseUrl="/api",this.environment="production"}validateNigerianPhone(e){try{const s=e.replace(/[^\d+]/g,"");if(!te(s,"NG"))return{valid:!1,error:"Please enter a valid Nigerian phone number"};const r=le(s,"NG"),i=r.formatInternational(),a=r.nationalNumber;if(10!==a.length)return{valid:!1,error:"Nigerian phone numbers must be 10 digits"};a.substring(0,3);return{valid:!0,formatted:i}}catch(s){return{valid:!1,error:"Invalid phone number format"}}}sendVerificationCode(e){return m(this,null,function*(){const s=this.validateNigerianPhone(e.phoneNumber);if(!s.valid)return{success:!1,message:s.error||"Invalid phone number",error:s.error};try{if("development"===this.environment)return{success:!0,message:"Verification code sent successfully (Development Mode)",requestId:`dev_${Date.now()}_${Math.random().toString(36).substring(7)}`};const r=yield fetch(`${this.apiBaseUrl}/sms/send-verification`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:s.formatted,countryCode:"NG",channel:e.channel||"sms"})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=yield r.json();return{success:i.success||!1,message:i.message||"Verification code sent",sid:i.sid,requestId:i.requestId}}catch(r){return{success:!1,message:"Failed to send verification code. Please try again.",error:r instanceof Error?r.message:"Unknown error"}}})}verifyOTP(e){return m(this,null,function*(){if(!e.otp||6!==e.otp.length)return{success:!1,message:"Please enter a valid 6-digit verification code",verified:!1,error:"Invalid OTP format"};try{if("development"===this.environment){const s="123456"===e.otp;return{success:s,message:s?"Phone number verified successfully":"Invalid verification code",verified:s,error:s?void 0:"Invalid OTP"}}const s=yield fetch(`${this.apiBaseUrl}/sms/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:e.phoneNumber,otp:e.otp,requestId:e.requestId})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=yield s.json();return{success:r.success||!1,message:r.message||(r.verified?"Verified successfully":"Invalid verification code"),verified:r.verified||!1,error:r.error}}catch(s){return{success:!1,message:"Verification failed. Please try again.",verified:!1,error:s instanceof Error?s.message:"Unknown error"}}})}resendVerificationCode(e){return m(this,null,function*(){return this.sendVerificationCode({phoneNumber:e})})}static formatPhoneNumber(e){try{return le(e,"NG").formatInternational()}catch(s){return e}}static getNetworkProvider(e){try{const s=le(e,"NG"),r=s.nationalNumber.substring(0,3);return{"080":"MTN/GLO/Airtel","081":"MTN/GLO/9mobile","070":"MTN/GLO/Airtel","090":"MTN/GLO/Airtel","091":"MTN"}[r]||"Nigerian Network"}catch(s){return"Unknown"}}static shouldRequirePhoneVerification(e){return!(null==e?void 0:e.verification_phone)||!!((null==e?void 0:e.services)&&e.services.length>0)&&!e.verification_phone}},fe=u.forwardRef((e,s)=>{var r=e,{className:i,containerClassName:a}=r,n=d(r,["className","containerClassName"]);return x.jsx(ce,l({ref:s,containerClassName:D("flex items-center gap-2 has-[:disabled]:opacity-50",a),className:D("disabled:cursor-not-allowed",i)},n))});fe.displayName="InputOTP";const pe=u.forwardRef((e,s)=>{var r=e,{className:i}=r,a=d(r,["className"]);return x.jsx("div",l({ref:s,className:D("flex items-center",i)},a))});pe.displayName="InputOTPGroup";const je=u.forwardRef((e,s)=>{var r=e,{index:i,className:a}=r,n=d(r,["index","className"]);const t=u.useContext(de),{char:o,hasFakeCaret:m,isActive:h}=t.slots[i];return x.jsxs("div",c(l({ref:s,className:D("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",h&&"z-10 ring-2 ring-ring ring-offset-background",a)},n),{children:[o,m&&x.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:x.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]}))});je.displayName="InputOTPSlot";const ge=u.forwardRef((e,s)=>{var r=d(e,[]);return x.jsx("div",c(l({ref:s,role:"separator"},r),{children:x.jsx(f,{})}))});ge.displayName="InputOTPSeparator";const ve=({open:e,onOpenChange:s,onVerificationComplete:r,initialPhoneNumber:i="",title:a="Verify Your Phone Number",description:n="We need to verify your Nigerian phone number for security and trust.",required:t=!1})=>{const[d,o]=u.useState({phoneNumber:i,isValidPhone:!1,otpSent:!1,otpCode:"",isVerifying:!1,isResending:!1}),[h,f]=u.useState("phone-input"),[w,C]=u.useState(0);u.useEffect(()=>{e&&(o({phoneNumber:i,isValidPhone:!1,otpSent:!1,otpCode:"",isVerifying:!1,isResending:!1}),f("phone-input"),C(0))},[e,i]),u.useEffect(()=>{let e;return w>0&&(e=setTimeout(()=>C(w-1),1e3)),()=>clearTimeout(e)},[w]);const P=!t||"verified"===h;return x.jsx(Z,{open:e,onOpenChange:P?s:void 0,children:x.jsxs(ee,{className:"sm:max-w-md",children:[x.jsxs(se,{children:[x.jsxs(re,{className:"flex items-center gap-2",children:["verified"===h?x.jsx(p,{className:"h-5 w-5 text-green-600"}):x.jsx(j,{className:"h-5 w-5 text-primary"}),a]}),x.jsx(ie,{children:"verified"===h?"Your phone number has been successfully verified!":n})]}),x.jsxs("div",{className:"space-y-6 py-4",children:["phone-input"===h&&x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(X,{htmlFor:"phone",children:"Nigerian Phone Number"}),x.jsx("div",{className:"phone-input-container",children:x.jsx(g,{country:"ng",value:d.phoneNumber.replace("+",""),onChange:e=>{const s=`+${e}`,r=ue.validateNigerianPhone(s);o(e=>c(l({},e),{phoneNumber:s,isValidPhone:r.valid,error:r.error}))},onlyCountries:["ng"],inputStyle:{width:"100%",height:"40px",fontSize:"14px",paddingLeft:"48px",border:"1px solid hsl(var(--border))",borderRadius:"6px"},buttonStyle:{border:"1px solid hsl(var(--border))",borderRadius:"6px 0 0 6px"},dropdownStyle:{border:"1px solid hsl(var(--border))",borderRadius:"6px"}})}),d.phoneNumber&&x.jsxs("p",{className:"text-sm text-muted-foreground",children:["Network: ",ue.constructor.getNetworkProvider(d.phoneNumber)]})]}),d.error&&x.jsxs(F,{variant:"destructive",children:[x.jsx(v,{className:"h-4 w-4"}),x.jsx(M,{children:d.error})]}),x.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(N,{className:"h-5 w-5 text-blue-600 mt-0.5"}),x.jsxs("div",{className:"text-sm",children:[x.jsx("p",{className:"font-medium text-blue-900",children:"Why verify your phone?"}),x.jsxs("ul",{className:"mt-2 text-blue-700 space-y-1",children:[x.jsx("li",{children:"• Secure your account from unauthorized access"}),x.jsx("li",{children:"• Build trust with other Nigerian businesses"}),x.jsx("li",{children:"• Required for offering services and receiving payments"})]})]})]})})]}),"otp-verification"===h&&x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx(y,{className:"h-12 w-12 text-primary mx-auto"}),x.jsx("h3",{className:"font-medium",children:"Enter Verification Code"}),x.jsxs("p",{className:"text-sm text-muted-foreground",children:["We sent a 6-digit code to",x.jsx("br",{}),x.jsx("strong",{children:ue.constructor.formatPhoneNumber(d.phoneNumber)})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("div",{className:"flex justify-center",children:x.jsxs(fe,{maxLength:6,value:d.otpCode,onChange:e=>o(s=>c(l({},s),{otpCode:e})),children:[x.jsxs(pe,{children:[x.jsx(je,{index:0}),x.jsx(je,{index:1}),x.jsx(je,{index:2})]}),x.jsx(ge,{}),x.jsxs(pe,{children:[x.jsx(je,{index:3}),x.jsx(je,{index:4}),x.jsx(je,{index:5})]})]})}),d.error&&x.jsxs(F,{variant:"destructive",children:[x.jsx(v,{className:"h-4 w-4"}),x.jsx(M,{children:d.error})]}),x.jsx("div",{className:"text-center",children:x.jsx(E,{variant:"ghost",size:"sm",onClick:()=>m(void 0,null,function*(){if(!(w>0||d.isResending)){o(e=>c(l({},e),{isResending:!0,error:void 0}));try{const e=yield ue.resendVerificationCode(d.phoneNumber);e.success?(o(s=>c(l({},s),{requestId:e.requestId,isResending:!1,otpCode:""})),C(60),$({title:"📱 Code Resent",description:"A new verification code has been sent to your phone."})):o(s=>c(l({},s),{error:e.message,isResending:!1}))}catch(e){o(e=>c(l({},e),{error:"Failed to resend code. Please try again.",isResending:!1}))}}}),disabled:w>0||d.isResending,children:d.isResending?x.jsxs(x.Fragment,{children:[x.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):w>0?`Resend in ${w}s`:"Resend Code"})})]})]}),"verified"===h&&x.jsxs("div",{className:"text-center space-y-4",children:[x.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:x.jsx(p,{className:"h-8 w-8 text-green-600"})}),x.jsxs("div",{className:"space-y-2",children:[x.jsx("h3",{className:"font-medium text-green-900",children:"Phone Number Verified!"}),x.jsx("p",{className:"text-sm text-green-700",children:"Your Nigerian phone number has been successfully verified. You can now offer services and receive payments."})]})]})]}),x.jsxs(ae,{children:["phone-input"===h&&x.jsxs("div",{className:"flex gap-3 w-full",children:[P&&x.jsx(E,{variant:"outline",onClick:()=>s(!1),children:t?"Skip for Now":"Cancel"}),x.jsx(E,{onClick:()=>m(void 0,null,function*(){if(d.isValidPhone&&!d.isVerifying){o(e=>c(l({},e),{isVerifying:!0,error:void 0}));try{const e=yield ue.sendVerificationCode({phoneNumber:d.phoneNumber});e.success?(o(s=>c(l({},s),{otpSent:!0,requestId:e.requestId,isVerifying:!1})),f("otp-verification"),C(60),$({title:"📱 SMS Sent!",description:"Check your phone for the verification code."})):o(s=>c(l({},s),{error:e.message,isVerifying:!1}))}catch(e){o(e=>c(l({},e),{error:"Failed to send verification code. Please try again.",isVerifying:!1}))}}}),disabled:!d.isValidPhone||d.isVerifying,className:"flex-1",children:d.isVerifying?x.jsxs(x.Fragment,{children:[x.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending Code..."]}):"Send Verification Code"})]}),"otp-verification"===h&&x.jsxs("div",{className:"flex gap-3 w-full",children:[x.jsx(E,{variant:"outline",onClick:()=>f("phone-input"),children:"Change Number"}),x.jsx(E,{onClick:()=>m(void 0,null,function*(){if(6===d.otpCode.length&&!d.isVerifying){o(e=>c(l({},e),{isVerifying:!0,error:void 0}));try{const e=yield ue.verifyOTP({phoneNumber:d.phoneNumber,otp:d.otpCode,requestId:d.requestId});e.success&&e.verified?(o(e=>c(l({},e),{success:!0,isVerifying:!1})),f("verified"),$({title:"✅ Phone Verified!",description:"Your Nigerian phone number has been verified successfully."}),setTimeout(()=>{r(d.phoneNumber),s(!1)},1500)):o(s=>c(l({},s),{error:e.message,isVerifying:!1,otpCode:""}))}catch(e){o(e=>c(l({},e),{error:"Verification failed. Please try again.",isVerifying:!1,otpCode:""}))}}}),disabled:6!==d.otpCode.length||d.isVerifying,className:"flex-1",children:d.isVerifying?x.jsxs(x.Fragment,{children:[x.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify Code"})]})]})]})})},Ne=({className:e="",compact:s=!1,initialPhoneNumber:r,onVerified:i})=>{var a,n;const{user:t,profile:l,updateProfile:c}=B(),[d,o]=u.useState(!1),f=null!=(n=null!=(a=null==l?void 0:l.phone_verified)?a:null==l?void 0:l.verification_phone)&&n,g=(null==l?void 0:l.phone)||r||"",y=e=>m(void 0,null,function*(){try{const{error:s}=yield c({phone:e,phone_verified:!0});s?$({variant:"destructive",title:"Profile Update Failed",description:s}):($({title:"✅ Phone Verified!",description:"Your phone number has been verified and saved to your profile."}),null==i||i(e))}catch(s){$({variant:"destructive",title:"Update Error",description:"Failed to update your profile. Please try again."})}}),b=ue.constructor.shouldRequirePhoneVerification(l);return s?x.jsxs(x.Fragment,{children:[x.jsx("div",{className:`flex items-center gap-2 ${e}`,children:f?x.jsxs(x.Fragment,{children:[x.jsxs(G,{variant:"outline",className:"text-green-600 border-green-200",children:[x.jsx(p,{className:"h-3 w-3 mr-1"}),"Phone Verified"]}),g&&x.jsx("span",{className:"text-sm text-muted-foreground",children:ue.constructor.formatPhoneNumber(g)})]}):x.jsxs(E,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"text-amber-600 border-amber-200 hover:bg-amber-50",children:[x.jsx(N,{className:"h-3 w-3 mr-1"}),"Verify Phone"]})}),x.jsx(ve,{open:d,onOpenChange:o,onVerificationComplete:y,initialPhoneNumber:g})]}):x.jsxs(x.Fragment,{children:[x.jsxs(Y,{className:e,children:[x.jsxs(W,{children:[x.jsxs(H,{className:"flex items-center gap-2",children:[f?x.jsx(p,{className:"h-5 w-5 text-green-600"}):x.jsx(N,{className:"h-5 w-5 text-primary"}),"Phone Verification",b&&!f&&x.jsx(G,{variant:"destructive",className:"ml-auto",children:"Required"})]}),x.jsx(J,{children:f?"Your Nigerian phone number is verified and trusted.":"Verify your Nigerian phone number to build trust and access all features."})]}),x.jsx(Q,{className:"space-y-4",children:f?x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:x.jsx(p,{className:"h-4 w-4 text-green-600"})}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-green-900",children:"Verified"}),x.jsx("p",{className:"text-sm text-green-700",children:ue.constructor.formatPhoneNumber(g)})]})]}),x.jsxs(G,{variant:"outline",className:"text-green-600 border-green-200",children:[x.jsx(h,{className:"h-3 w-3 mr-1"}),"Trusted"]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[x.jsx(j,{className:"h-4 w-4"}),x.jsx("span",{children:"Account Secured"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[x.jsx(p,{className:"h-4 w-4"}),x.jsx("span",{children:"Can Offer Services"})]})]}),x.jsx(E,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"w-full",children:"Update Phone Number"})]}):x.jsxs("div",{className:"space-y-4",children:[x.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(v,{className:"h-5 w-5 text-amber-600 mt-0.5"}),x.jsxs("div",{className:"text-sm",children:[x.jsx("p",{className:"font-medium text-amber-900",children:"Verification Required"}),x.jsx("p",{className:"text-amber-700 mt-1",children:"Nigerian businesses need phone verification to:"}),x.jsxs("ul",{className:"mt-2 text-amber-700 space-y-1",children:[x.jsx("li",{children:"• Offer services to other businesses"}),x.jsx("li",{children:"• Receive payments and time credits"}),x.jsx("li",{children:"• Build trust in the community"})]})]})]})}),g&&x.jsxs("div",{className:"text-sm text-muted-foreground",children:["Current: ",ue.constructor.formatPhoneNumber(g)]}),x.jsxs(E,{onClick:()=>o(!0),className:"w-full",size:"lg",children:[x.jsx(N,{className:"h-4 w-4 mr-2"}),"Verify Phone Number"]})]})})]}),x.jsx(ve,{open:d,onOpenChange:o,onVerificationComplete:y,initialPhoneNumber:g,required:b})]})};function ye({userId:e,isOwnProfile:s=!1}){const[r,i]=u.useState([]),[a,n]=u.useState(null),[t,l]=u.useState(!0),[c,d]=u.useState(null),[o,f]=u.useState("");u.useEffect(()=>{p()},[e]);const p=()=>m(this,null,function*(){l(!0);try{const{data:s,error:r}=yield K.from("reviews").select("\n          *,\n          reviewer:reviewer_id (\n            id,\n            display_name,\n            avatar_url,\n            category\n          )\n        ").eq("reviewee_id",e).order("created_at",{ascending:!1});if(r)throw r;i(s||[]),j(s||[])}catch(s){}finally{l(!1)}}),j=e=>{if(0===e.length)return void n(null);const s=e.reduce((e,s)=>e+s.overall_rating,0)/e.length,r=[5,4,3,2,1].map(s=>{const r=e.filter(e=>e.overall_rating===s).length;return{stars:s,count:r,percentage:r/e.length*100}}),i={communication:e.reduce((e,s)=>e+(s.communication_rating||0),0)/e.filter(e=>e.communication_rating).length||0,quality:e.reduce((e,s)=>e+(s.quality_rating||0),0)/e.filter(e=>e.quality_rating).length||0,timeliness:e.reduce((e,s)=>e+(s.timeliness_rating||0),0)/e.filter(e=>e.timeliness_rating).length||0,professionalism:e.reduce((e,s)=>e+(s.professionalism_rating||0),0)/e.filter(e=>e.professionalism_rating).length||0};n({average:s,count:e.length,distribution:r,dimensions:i})},g=e=>m(this,null,function*(){if(o.trim())try{const{error:s}=yield K.from("reviews").update({response_text:o.trim(),response_date:(new Date).toISOString()}).eq("id",e);if(s)throw s;p(),d(null),f("")}catch(s){}}),v=(e,s="md")=>{const r="sm"===s?"h-3 w-3":"md"===s?"h-4 w-4":"h-5 w-5";return x.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(s=>x.jsx(h,{className:`${r} ${s<=e?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},s))})};return t?x.jsx("div",{className:"flex items-center justify-center py-8",children:x.jsx("p",{className:"text-muted-foreground",children:"Loading reviews..."})}):0===r.length?x.jsx("div",{className:"text-center py-8",children:x.jsx("p",{className:"text-muted-foreground",children:s?"You haven't received any reviews yet":"No reviews yet"})}):x.jsxs("div",{className:"space-y-6",children:[a&&x.jsx(Y,{children:x.jsx(Q,{className:"pt-6",children:x.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-end gap-2 mb-4",children:[x.jsx("span",{className:"text-5xl font-bold",children:a.average.toFixed(1)}),x.jsxs("div",{className:"pb-2",children:[v(Math.round(a.average),"lg"),x.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[a.count," ",1===a.count?"review":"reviews"]})]})]}),x.jsx("div",{className:"space-y-2",children:a.distribution.map(({stars:e,count:s,percentage:r})=>x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsxs("span",{className:"text-sm w-12",children:[e," stars"]}),x.jsx(oe,{value:r,className:"h-2"}),x.jsx("span",{className:"text-sm text-muted-foreground w-8",children:s})]},e))})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold mb-4",children:"Rating Breakdown"}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm",children:"Communication"}),x.jsxs("div",{className:"flex items-center gap-2",children:[v(Math.round(a.dimensions.communication),"sm"),x.jsx("span",{className:"text-sm font-medium w-8",children:a.dimensions.communication.toFixed(1)})]})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm",children:"Quality"}),x.jsxs("div",{className:"flex items-center gap-2",children:[v(Math.round(a.dimensions.quality),"sm"),x.jsx("span",{className:"text-sm font-medium w-8",children:a.dimensions.quality.toFixed(1)})]})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm",children:"Timeliness"}),x.jsxs("div",{className:"flex items-center gap-2",children:[v(Math.round(a.dimensions.timeliness),"sm"),x.jsx("span",{className:"text-sm font-medium w-8",children:a.dimensions.timeliness.toFixed(1)})]})]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm",children:"Professionalism"}),x.jsxs("div",{className:"flex items-center gap-2",children:[v(Math.round(a.dimensions.professionalism),"sm"),x.jsx("span",{className:"text-sm font-medium w-8",children:a.dimensions.professionalism.toFixed(1)})]})]})]})]})]})})}),x.jsx("div",{className:"space-y-4",children:r.map(e=>{var r,i,a,n,t;return x.jsx(Y,{children:x.jsxs(Q,{className:"pt-6",children:[x.jsxs("div",{className:"flex items-start justify-between mb-4",children:[x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsxs(z,{className:"h-10 w-10",children:[x.jsx(U,{src:(null==(r=e.reviewer)?void 0:r.avatar_url)||""}),x.jsx(A,{children:(null==(a=null==(i=e.reviewer)?void 0:i.display_name)?void 0:a.charAt(0))||"U"})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("h4",{className:"font-semibold",children:(null==(n=e.reviewer)?void 0:n.display_name)||"Anonymous"}),e.is_verified&&x.jsx(G,{variant:"secondary",children:"Verified"}),e.is_featured&&x.jsx(G,{variant:"default",children:"Featured"})]}),(null==(t=e.reviewer)?void 0:t.category)&&x.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:e.reviewer.category}),x.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:me(new Date(e.created_at),{addSuffix:!0})})]})]}),x.jsxs("div",{className:"flex flex-col items-end gap-1",children:[v(e.overall_rating),x.jsxs("span",{className:"text-sm font-medium",children:[e.overall_rating,"/5"]})]})]}),x.jsx("h3",{className:"font-semibold text-lg mb-2",children:e.review_title}),x.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:e.review_text}),x.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-muted-foreground mb-4",children:[e.would_recommend&&x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(w,{className:"h-3 w-3 text-primary"}),x.jsx("span",{children:"Would recommend"})]}),e.work_location&&x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(C,{className:"h-3 w-3"}),x.jsx("span",{children:e.work_location})]})]}),e.response_text&&x.jsxs("div",{className:"bg-muted rounded-lg p-4 mt-4",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx(y,{className:"h-4 w-4 text-primary"}),x.jsx("span",{className:"font-medium text-sm",children:"Response from business owner"})]}),x.jsx("p",{className:"text-sm",children:e.response_text}),e.response_date&&x.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:me(new Date(e.response_date),{addSuffix:!0})})]}),s&&!e.response_text&&x.jsx("div",{className:"mt-4",children:c===e.id?x.jsxs("div",{className:"space-y-2",children:[x.jsx(ne,{placeholder:"Write your response...",value:o,onChange:e=>f(e.target.value),rows:3,maxLength:500}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx(E,{size:"sm",onClick:()=>g(e.id),disabled:!o.trim(),children:"Submit Response"}),x.jsx(E,{size:"sm",variant:"outline",onClick:()=>{d(null),f("")},children:"Cancel"})]})]}):x.jsxs(E,{size:"sm",variant:"ghost",onClick:()=>d(e.id),className:"text-primary",children:[x.jsx(y,{className:"h-4 w-4 mr-2"}),"Respond to this review"]})})]})},e.id)})})]})}const be=u.forwardRef((e,s)=>{var r=e,{className:i}=r,a=d(r,["className"]);return x.jsx(P,c(l({className:D("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",i)},a),{ref:s,children:x.jsx(_,{className:D("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});function we(){var e,s;const{profile:r,updateProfile:i,services:a,trades:n,fetchServices:t,fetchTrades:d}=B(),[o,h]=u.useState(!1);u.useState("overview");const[f,g]=u.useState({display_name:(null==r?void 0:r.display_name)||"",phone:(null==r?void 0:r.phone)||"",location:(null==r?void 0:r.location)||"",category:(null==r?void 0:r.category)||"",bio:"",working_hours:"9 AM - 5 PM",languages:"English"});if(u.useEffect(()=>{t(),d()},[t,d]),!r)return null;const v=new Date(r.created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}),w=n.filter(e=>"completed"===e.status).length,P=n.length>0?Math.round(w/n.length*100):0;return x.jsx(L,{children:x.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 p-6",children:[x.jsxs(Y,{className:"relative overflow-hidden",children:[x.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-accent/10 to-primary/5"}),x.jsx(Q,{className:"relative p-8",children:x.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[x.jsxs("div",{className:"relative",children:[x.jsxs(z,{className:"w-32 h-32 border-4 border-background shadow-lg",children:[x.jsx(U,{src:r.avatar_url}),x.jsx(A,{className:"text-3xl font-bold bg-gradient-to-br from-accent to-primary text-white",children:(null==(s=null==(e=r.display_name)?void 0:e[0])?void 0:s.toUpperCase())||"U"})]}),x.jsx(E,{size:"sm",className:"absolute -bottom-2 -right-2 rounded-full",onClick:()=>h(!0),children:x.jsx(k,{className:"h-4 w-4"})})]}),x.jsxs("div",{className:"flex-1 space-y-4",children:[x.jsxs("div",{children:[o?x.jsx(xe,{value:f.display_name,onChange:e=>g(c(l({},f),{display_name:e.target.value})),className:"text-3xl font-bold border-none p-0 h-auto"}):x.jsx("h1",{className:"text-3xl font-bold font-brand",children:r.display_name||"Unnamed User"}),x.jsx("p",{className:"text-muted-foreground",children:r.email}),x.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[x.jsxs("span",{className:"flex items-center gap-1",children:[x.jsx(V,{className:"h-4 w-4"}),"Member since ",v]}),r.location&&x.jsxs("span",{className:"flex items-center gap-1",children:[x.jsx(C,{className:"h-4 w-4"}),r.location]})]})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(he,{score:r.trust_score}),x.jsxs("span",{className:"font-semibold",children:[r.trust_score/20,"/5"]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[r.verification_email&&x.jsx(p,{className:"h-4 w-4 text-green-500"}),r.verification_phone&&x.jsx(N,{className:"h-4 w-4 text-green-500"}),r.verification_cac&&x.jsx(j,{className:"h-4 w-4 text-green-500"}),x.jsx("span",{className:"text-sm text-muted-foreground",children:"Verified"})]})]}),x.jsx("div",{className:"flex gap-2",children:o?x.jsxs("div",{className:"flex gap-2",children:[x.jsx(E,{onClick:()=>m(this,null,function*(){const{error:e}=yield i(f);e?$({variant:"destructive",title:"Update Failed",description:e}):($({title:"Profile Updated",description:"Your profile has been updated successfully."}),h(!1))}),children:"Save Changes"}),x.jsx(E,{variant:"outline",onClick:()=>h(!1),children:"Cancel"})]}):x.jsxs(E,{onClick:()=>h(!0),children:[x.jsx(S,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]}),x.jsxs("div",{className:"flex flex-col gap-2",children:[x.jsx(E,{variant:"outline",size:"sm",onClick:()=>{var e;(null==(e=navigator.share)?void 0:e.call(navigator,{title:`${r.display_name}'s Profile`,url:window.location.href}))||navigator.clipboard.writeText(window.location.href),$({title:"Profile link copied!"})},children:x.jsx(O,{className:"h-4 w-4"})}),x.jsx(E,{variant:"outline",size:"sm",children:x.jsx(R,{className:"h-4 w-4"})}),x.jsx(E,{variant:"outline",size:"sm",children:x.jsx(T,{className:"h-4 w-4"})})]})]})})]}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[x.jsx(Y,{children:x.jsxs(Q,{className:"p-6 text-center",children:[x.jsx("div",{className:"text-2xl font-bold text-accent",children:"10"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Hours Balance"}),x.jsx(q,{className:"h-4 w-4 text-green-500 mx-auto mt-1"})]})}),x.jsx(Y,{children:x.jsxs(Q,{className:"p-6 text-center",children:[x.jsx("div",{className:"text-2xl font-bold",children:w}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed Trades"})]})}),x.jsx(Y,{children:x.jsxs(Q,{className:"p-6 text-center",children:[x.jsxs("div",{className:"text-2xl font-bold",children:[P,"%"]}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Success Rate"})]})}),x.jsx(Y,{children:x.jsxs(Q,{className:"p-6 text-center",children:[x.jsx("div",{className:"text-2xl font-bold",children:"2h"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Response"})]})})]}),x.jsxs(Y,{children:[x.jsx(W,{children:x.jsx(H,{children:"About"})}),x.jsx(Q,{className:"space-y-4",children:o?x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx(X,{children:"Bio"}),x.jsx(ne,{value:f.bio,onChange:e=>g(c(l({},f),{bio:e.target.value})),placeholder:"Tell others about yourself and your expertise...",rows:4})]}),x.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx(X,{children:"Category"}),x.jsx(xe,{value:f.category,onChange:e=>g(c(l({},f),{category:e.target.value})),placeholder:"e.g., Design, Development, Marketing"})]}),x.jsxs("div",{children:[x.jsx(X,{children:"Location"}),x.jsx(xe,{value:f.location,onChange:e=>g(c(l({},f),{location:e.target.value})),placeholder:"City, Country"})]}),x.jsxs("div",{children:[x.jsx(X,{children:"Languages"}),x.jsx(xe,{value:f.languages,onChange:e=>g(c(l({},f),{languages:e.target.value})),placeholder:"Languages you speak"})]}),x.jsxs("div",{children:[x.jsx(X,{children:"Working Hours"}),x.jsx(xe,{value:f.working_hours,onChange:e=>g(c(l({},f),{working_hours:e.target.value})),placeholder:"e.g., 9 AM - 5 PM"})]})]})]}):x.jsxs("div",{className:"space-y-4",children:[x.jsx("p",{className:"text-muted-foreground",children:f.bio||"This user hasn't added a bio yet."}),x.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:r.category||"Category not specified"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(C,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:r.location||"Location not specified"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(y,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:f.languages})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),x.jsx("span",{children:f.working_hours})]})]})]})})]}),x.jsxs(Y,{children:[x.jsx(W,{children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx(H,{children:"Services Offered"}),x.jsx(E,{size:"sm",children:"Add Service"})]})}),x.jsx(Q,{children:a.length>0?x.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>x.jsx(Y,{className:"border",children:x.jsx(Q,{className:"p-4",children:x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{className:"flex-1",children:[x.jsx("h4",{className:"font-semibold",children:e.title}),x.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),x.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[x.jsx(he,{score:85}),x.jsx("span",{className:"text-sm",children:"12 completed"})]}),x.jsxs("div",{className:"flex items-center justify-between mt-2",children:[x.jsxs("span",{className:"font-semibold",children:["$",e.hourly_rate,"/hr"]}),x.jsx(be,{checked:e.availability})]})]}),x.jsx(E,{variant:"ghost",size:"sm",children:x.jsx(S,{className:"h-4 w-4"})})]})})},e.id))}):x.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No services offered yet. Add your first service to get started!"})})]}),x.jsxs(Y,{children:[x.jsx(W,{children:x.jsx(H,{children:"Recent Activity"})}),x.jsx(Q,{children:x.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map(e=>x.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-muted/50",children:[x.jsx("div",{className:"w-2 h-2 rounded-full bg-accent"}),x.jsxs("div",{className:"flex-1",children:[x.jsx("p",{className:"font-medium",children:"Trade completed"}),x.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.hours_offered," hours • ",new Date(e.created_at).toLocaleDateString()]})]}),x.jsx(G,{variant:"outline",children:e.status})]},e.id)),0===n.length&&x.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No recent activity"})]})})]}),x.jsxs(Y,{children:[x.jsx(W,{children:x.jsx(H,{children:"Reviews & Ratings"})}),x.jsx(Q,{children:x.jsx(ye,{userId:r.id,isOwnProfile:!0})})]}),x.jsx(Ne,{})]})})}be.displayName=P.displayName;export{we as default};
