import{r as e,x as s,j as t,$ as l,L as a,a7 as r,F as i,z as c,a8 as d,a1 as n,k as o,K as m}from"./react-vendor-CnY34O61.js";import{L as x}from"./Layout-r0cnXxiB.js";import{u as h,d as u,C as j,c as p,S as g,B as v}from"./index-CjTRKdPh.js";import{T as N,a as f,b,c as y}from"./tabs-XccOGY67.js";import"./vendor-CwuJVHC1.js";import"./backend-vendor-CggdsxVJ.js";import"./ui-vendor-CttiZxwU.js";import"./utils-vendor-BkyaMd0J.js";import"./query-vendor-vr-56lSy.js";const w=e=>{const s={pending:{icon:o,color:"bg-yellow-100 text-yellow-800 border-yellow-200",label:"Pending"},negotiating:{icon:n,color:"bg-blue-100 text-blue-800 border-blue-200",label:"Negotiating"},accepted:{icon:d,color:"bg-green-100 text-green-800 border-green-200",label:"Accepted"},active:{icon:c,color:"bg-purple-100 text-purple-800 border-purple-200",label:"Active"},completed:{icon:d,color:"bg-green-100 text-green-800 border-green-200",label:"Completed"},disputed:{icon:i,color:"bg-red-100 text-red-800 border-red-200",label:"Disputed"},cancelled:{icon:m,color:"bg-gray-100 text-gray-800 border-gray-200",label:"Cancelled"}},l=s[e]||s.pending,a=l.icon;return t.jsxs(v,{variant:"outline",className:`${l.color} flex items-center gap-1`,children:[t.jsx(a,{className:"w-3 h-3"}),l.label]})},T=e=>{const s=new Date(e),t=(new Date).getTime()-s.getTime(),l=Math.floor(t/864e5);return 0===l?"Today":1===l?"Yesterday":l<7?`${l} days ago`:s.toLocaleDateString("en-NG",{month:"short",day:"numeric",year:"numeric"})};function k(){const{trades:o,fetchTrades:m,user:v}=h(),[k,S]=e.useState(!0),[C,P]=e.useState(null),A=s();e.useEffect(()=>{(()=>{return e=this,s=null,t=function*(){try{S(!0),P(null),yield m()}catch(e){P("Failed to load trades. Please try again.")}finally{S(!1)}},new Promise((l,a)=>{var r=e=>{try{c(t.next(e))}catch(s){a(s)}},i=e=>{try{c(t.throw(e))}catch(s){a(s)}},c=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,i);c((t=t.apply(e,s)).next())});var e,s,t})()},[m]);const{activeTrades:D,completedTrades:$,allTrades:_}=e.useMemo(()=>({activeTrades:o.filter(e=>["pending","negotiating","accepted","active"].includes(e.status)),completedTrades:o.filter(e=>["completed","cancelled","disputed"].includes(e.status)),allTrades:o}),[o]),q=e=>{const s=e.proposer_id===(null==v?void 0:v.id),a=e.service_offered,i=e.service_requested;return t.jsx(j,{className:"hover:shadow-lg transition cursor-pointer group",onClick:()=>A(`/trades/${e.id}`),children:t.jsxs(p,{className:"p-6",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h4",{className:"font-semibold text-lg group-hover:text-primary transition",children:s?"You Proposed":"Proposal Received"}),w(e.status)]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:T(e.created_at)})]})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[t.jsx(r,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Offering"}),t.jsx("p",{className:"text-sm font-medium",children:(null==a?void 0:a.title)||"Service"}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.hours_offered," hours • ",(null==a?void 0:a.category)||"Service"]})]})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(l,{className:"w-5 h-5 text-muted-foreground"})}),t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx(r,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Requesting"}),t.jsx("p",{className:"text-sm font-medium",children:(null==i?void 0:i.title)||"Service"}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.hours_requested," hours • ",(null==i?void 0:i.category)||"Service"]})]})]})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t flex items-center justify-between",children:[t.jsx(u,{variant:"ghost",size:"sm",onClick:s=>{s.stopPropagation(),A(`/trades/${e.id}`)},children:"View Details"}),t.jsxs(u,{variant:"outline",size:"sm",onClick:s=>{s.stopPropagation(),A(`/trades/${e.id}?tab=messages`)},children:[t.jsx(n,{className:"w-4 h-4 mr-2"}),"Message"]})]})]})},e.id)},M=e=>{const s={active:{title:"No Active Trades",description:"You don't have any active trades at the moment. Browse services to start trading time instead of money!",action:"Browse Services",link:"/discover"},completed:{title:"No Completed Trades",description:"You haven't completed any trades yet. Once you finish a trade, it will appear here.",action:"View Active Trades",link:"/trades"},all:{title:"No Trades Yet",description:"Start your first trade! Find services you need and offer your skills in exchange. Save money by trading time.",action:"Discover Services",link:"/discover"}}[e];return t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx(l,{className:"w-8 h-8 text-primary"})}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:s.title}),t.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:s.description}),t.jsx(u,{asChild:!0,children:t.jsx(a,{to:s.link,children:s.action})})]})},Y=()=>t.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>t.jsx(j,{children:t.jsxs(p,{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"space-y-2 flex-1",children:[t.jsx(g,{className:"h-6 w-48"}),t.jsx(g,{className:"h-4 w-32"})]}),t.jsx(g,{className:"h-6 w-24"})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(g,{className:"h-20 w-full"}),t.jsx(g,{className:"h-6 w-12 mx-auto"}),t.jsx(g,{className:"h-20 w-full"})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t flex gap-2",children:[t.jsx(g,{className:"h-9 w-32"}),t.jsx(g,{className:"h-9 w-32"})]})]})},e))});return t.jsx(x,{children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-brand flex items-center gap-2",children:[t.jsx(l,{className:"w-8 h-8 text-primary"}),"My Trades"]}),t.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your time-trading agreements"})]}),t.jsx(u,{asChild:!0,children:t.jsxs(a,{to:"/discover",children:[t.jsx(r,{className:"w-4 h-4 mr-2"}),"Browse Services"]})})]}),C&&t.jsx(j,{className:"border-red-200 bg-red-50",children:t.jsxs(p,{className:"p-4 flex items-center gap-3",children:[t.jsx(i,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),t.jsx("div",{className:"flex-1",children:t.jsx("p",{className:"text-sm font-medium text-red-800",children:C})}),t.jsx(u,{variant:"outline",size:"sm",onClick:()=>{P(null),m()},children:"Retry"})]})}),!k&&!C&&_.length>0&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(j,{children:t.jsx(p,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"}),t.jsx("p",{className:"text-2xl font-bold",children:D.length})]}),t.jsx(c,{className:"w-8 h-8 text-primary"})]})})}),t.jsx(j,{children:t.jsx(p,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),t.jsx("p",{className:"text-2xl font-bold",children:$.length})]}),t.jsx(d,{className:"w-8 h-8 text-green-600"})]})})}),t.jsx(j,{children:t.jsx(p,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),t.jsx("p",{className:"text-2xl font-bold",children:_.length})]}),t.jsx(l,{className:"w-8 h-8 text-purple-600"})]})})})]}),t.jsxs(N,{defaultValue:"active",className:"w-full",children:[t.jsxs(f,{className:"grid w-full grid-cols-3",children:[t.jsxs(b,{value:"active",children:["Active (",D.length,")"]}),t.jsxs(b,{value:"completed",children:["Completed (",$.length,")"]}),t.jsxs(b,{value:"all",children:["All (",_.length,")"]})]}),t.jsx(y,{value:"active",className:"mt-6",children:k?Y():0===D.length?M("active"):t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:D.map(q)})}),t.jsx(y,{value:"completed",className:"mt-6",children:k?Y():0===$.length?M("completed"):t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:$.map(q)})}),t.jsx(y,{value:"all",className:"mt-6",children:k?Y():0===_.length?M("all"):t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:_.map(q)})})]})]})})}export{k as default};
