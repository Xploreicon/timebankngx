import{r as e,j as s,x as t,R as r,z as a,k as n,L as i,m as d,E as c}from"./react-vendor-CnY34O61.js";import{L as l}from"./Layout-r0cnXxiB.js";import{u as o,B as m,C as x,a as u,b as h,c as j,d as f}from"./index-CjTRKdPh.js";import{P as p}from"./progress-DkfyDUd2.js";import"./vendor-CwuJVHC1.js";import"./backend-vendor-CggdsxVJ.js";import"./ui-vendor-CttiZxwU.js";import"./utils-vendor-BkyaMd0J.js";import"./query-vendor-vr-56lSy.js";const v=()=>{var t;const{profile:r}=o(),[a,n]=e.useState(0),i=Number(null!=(t=null==r?void 0:r.available_credits)?t:0);return e.useEffect(()=>{const e=i;let s;const t=performance.now(),r=a=>{const i=Math.min(1,(a-t)/800),d=1===i?e:Number((e*i).toFixed(1));n(d),i<1&&(s=requestAnimationFrame(r))};return s=requestAnimationFrame(r),()=>cancelAnimationFrame(s)},[i]),s.jsxs("div",{className:"rounded-xl p-6 bg-gradient-to-br from-accent/30 to-primary/5 border shadow-[var(--shadow-elevate)]",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Time Credits"}),s.jsxs("div",{className:"mt-2 text-4xl font-brand",children:["⏰ ",a.toFixed(a%1==0?0:1)," hrs"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Earn by offering services. Spend to get help."})]})},g={pending:"bg-muted text-foreground",active:"bg-accent text-accent-foreground",completed:"bg-secondary text-secondary-foreground",disputed:"bg-destructive text-destructive-foreground"},N=()=>{const{trades:e,fetchTrades:a}=o(),n=t();return r.useEffect(()=>{a()},[a]),s.jsxs("div",{className:"grid sm:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.map(e=>{var t,r;const a=e.hours_requested||1,i="completed"===e.status?a:Math.floor(a/2),d=Math.round(i/a*100);return s.jsxs("div",{className:"p-4 rounded-lg border hover:shadow-md transition cursor-pointer",onClick:()=>n(`/trades/${e.id}`),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-semibold",children:(null==(t=e.service_requested)?void 0:t.title)||"Trade"}),s.jsx(m,{className:`${g[e.status]} capitalize`,children:e.status})]}),s.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["For ",(null==(r=e.service_offered)?void 0:r.title)||"Service"]}),s.jsx(p,{className:"mt-3",value:d}),s.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[i,"h / ",a,"h"]})]},e.id)}),0===e.length&&s.jsx("div",{className:"col-span-full text-center p-6 text-muted-foreground",children:"No active trades yet. Start trading to see your progress here!"})]})},b=()=>{const{notifications:e}=o();return s.jsxs("div",{className:"space-y-3",children:[e.slice(0,5).map(e=>{const t=(e=>{if(e instanceof Date)return isNaN(e.getTime())?null:e;if("string"==typeof e||"number"==typeof e){const s=new Date(e);return isNaN(s.getTime())?null:s}return null})("time"in e?e.time:null),r=t?t.toLocaleTimeString():"";return s.jsxs("div",{className:"p-3 rounded-md border bg-card animate-fade-in",children:[s.jsx("div",{className:"text-sm",children:e.text}),s.jsx("div",{className:"text-xs text-muted-foreground",children:r})]},e.id)}),0===e.length&&s.jsx("div",{className:"p-6 text-center text-muted-foreground border rounded-md",children:"No notifications yet"})]})},y=()=>{var t;const{profile:r,trades:m,fetchTrades:p}=o(),g=e.useMemo(()=>m.filter(e=>["active","accepted","pending"].includes(e.status)).length,[m]),y=null!=(t=null==r?void 0:r.average_response_hours)?t:0;return e.useEffect(()=>{p()},[p]),s.jsx(l,{children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("section",{className:"text-center space-y-2",children:[s.jsxs("h1",{className:"text-3xl font-brand",children:["Welcome back, ",(null==r?void 0:r.display_name)||"User","!"]}),s.jsx("p",{className:"text-muted-foreground",children:"Ready to trade some time? Check out what's happening in your network."})]}),s.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx(v,{}),s.jsxs(x,{children:[s.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(h,{className:"text-sm font-medium",children:"Active Trades"}),s.jsx(a,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(j,{children:[s.jsx("div",{className:"text-2xl font-bold",children:g}),s.jsx("p",{className:"text-xs text-muted-foreground",children:0===g?"No active trades yet":"In progress across your services"})]})]}),s.jsxs(x,{children:[s.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsx(h,{className:"text-sm font-medium",children:"Response Time"}),s.jsx(n,{className:"h-4 w-4 text-muted-foreground"})]}),s.jsxs(j,{children:[s.jsx("div",{className:"text-2xl font-bold",children:y>0?`${y.toFixed(1)}h`:"—"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:y>0?"Average response time":"No response data yet"})]})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-xl font-brand mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(f,{asChild:!0,className:"h-20 flex-col gap-2",children:s.jsxs(i,{to:"/discover",children:[s.jsx(d,{className:"h-6 w-6"}),s.jsx("span",{children:"Find Services"})]})}),s.jsx(f,{asChild:!0,variant:"outline",className:"h-20 flex-col gap-2",children:s.jsxs(i,{to:"/services",children:[s.jsx(c,{className:"h-6 w-6"}),s.jsx("span",{children:"Offer Service"})]})}),s.jsx(f,{asChild:!0,variant:"outline",className:"h-20 flex-col gap-2",children:s.jsxs(i,{to:"/trades",children:[s.jsx(a,{className:"h-6 w-6"}),s.jsx("span",{children:"View Matches"})]})})]})]}),s.jsxs("section",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-brand",children:"Active Trades"}),s.jsx(f,{asChild:!0,variant:"outline",size:"sm",children:s.jsx(i,{to:"/trades",children:"View All"})})]}),s.jsx(N,{})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-xl font-brand mb-4",children:"Recent Activity"}),s.jsx(b,{})]})]})})};export{y as default};
