var e=Object.defineProperty,t=(t,a,r)=>((t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r)(t,"symbol"!=typeof a?a+"":a,r),a=(e,t,a)=>new Promise((r,s)=>{var n=e=>{try{o(a.next(e))}catch(t){s(t)}},c=e=>{try{o(a.throw(e))}catch(t){s(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,c);o((a=a.apply(e,t)).next())});import{s as r}from"./index-CjTRKdPh.js";const s=class e{constructor(){t(this,"categoryRates",{Legal:{baseRate:10,demand:1.5,supply:.8},Tech:{baseRate:8,demand:1.4,supply:1},Creative:{baseRate:5,demand:1.2,supply:1.1},Fashion:{baseRate:4,demand:1,supply:1.2},Food:{baseRate:3,demand:.9,supply:1.3},Professional:{baseRate:6,demand:1.1,supply:1},Accounting:{baseRate:7,demand:1.3,supply:.9},Marketing:{baseRate:6,demand:1.2,supply:1.1},Photography:{baseRate:5,demand:1.1,supply:1.2},"Event Planning":{baseRate:4,demand:1,supply:1.1},Tailoring:{baseRate:3,demand:.8,supply:1.4},"Generator Repair":{baseRate:6,demand:1.4,supply:.7},Transportation:{baseRate:2,demand:.7,supply:1.5},Tutoring:{baseRate:4,demand:1,supply:1.3}})}static getInstance(){return e.instance||(e.instance=new e),e.instance}calculateCredits(e,t){const a=this.categoryRates[t];if(!a)return 5*e;const{baseRate:r,demand:s,supply:n}=a,c=r*s/n;return Math.round(e*c*100)/100}calculateExchangeRate(e,t){const a=this.calculateCredits(1,e),r=this.calculateCredits(1,t);return Math.round(a/r*100)/100}calculateTradeExchange(e,t,a){const r=this.calculateCredits(e,t),s=this.calculateExchangeRate(t,a),n=Math.round(e*s*100)/100;return{hoursB:n,exchangeRate:s,creditsA:r,creditsB:this.calculateCredits(n,a)}}getAllCategoryRates(){const e={};return Object.keys(this.categoryRates).forEach(t=>{e[t]=this.calculateCredits(1,t)}),e}updateMarketRates(e,t,a){this.categoryRates[e]&&(this.categoryRates[e].demand=Math.max(.5,Math.min(2,t)),this.categoryRates[e].supply=Math.max(.5,Math.min(2,a)))}addCredits(e,t,s,n,c){return a(this,null,function*(){try{const{data:a,error:s}=yield r.from("profiles").select("trust_score").eq("id",e).single();if(s)throw s;const n=(a.trust_score||0)+t,{error:c}=yield r.from("profiles").update({trust_score:Math.max(0,n)}).eq("id",e);if(c)throw c;return{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to add credits"}}})}spendCredits(e,t,s,n){return a(this,null,function*(){try{const{data:a,error:s}=yield r.from("profiles").select("trust_score").eq("id",e).single();if(s)throw s;const n=a.trust_score||0;if(n<t)return{success:!1,error:"Insufficient credits"};const c=n-t,{error:o}=yield r.from("profiles").update({trust_score:c}).eq("id",e);if(o)throw o;return{success:!0,newBalance:c}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to spend credits"}}})}getCreditBalance(e){return a(this,null,function*(){try{const{data:t,error:a}=yield r.from("profiles").select("trust_score").eq("id",e).single();if(a)throw a;return{balance:t.trust_score||0}}catch(t){return{balance:0,error:t instanceof Error?t.message:"Failed to get balance"}}})}calculateServicePotentialEarnings(e,t=10){const a=this.calculateCredits(1,e),r=a*t,s=4*r;return{weeklyCredits:Math.round(100*r)/100,monthlyCredits:Math.round(100*s)/100,categoryRate:a}}};t(s,"instance");const n=s.getInstance();export{n as t};
